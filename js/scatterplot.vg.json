{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 615,
"height": 400,
"title":"scatterplot",
  "description": "A scatterplot of population and average cases",
  "data": {
    "url": "https://raw.githubusercontent.com/HAONANTAO/FIT3179-Assignment2/main/data/COVID-19-2.csv"
  },
"params": [
  {"name": "Population_Above",
      "value": 0,
      "bind": {
      "input": "range",
     
      "min": 0,
      "max": 100000000,
      "step": 1000000,
      "name": "Minimum Population: "
      }
      },
{"name": "Continent_selection",
"bind": {
"input": "select",
"options": [
null,
"North America",
"South America",
"Europe",
"Africa",
"Asia",
"Oceania"
],
"labels":[
"Show All",
"North America",
"South America",
"Europe",
"Africa",
"Asia",
"Oceania"
],
"name": "Continent Selection: "
}
}
],
"transform": [{"filter": "Continent_selection == null || datum.Continent == Continent_selection"},
{"filter": "datum.Population > Population_Above"}],
  
  
  "encoding": {
    "x": {
      "field": "Population aged 65 and over (%)",
      "type": "quantitative"
    },
    "y": {
      "aggregate":"average",
      "field": "Cases",
      "type": "quantitative"
    }},
    "layer": [
      {
      "selection": {
      "continent_highlight": {
      "type": "multi",
      "fields": ["Continent"],
      "bind": "legend"
      }
      },
      "mark": "circle",
      "encoding": {
      "size": {
          "field": "Population",
          "type": "quantitative",
          "scale": {
          "type": "threshold",
          "domain": [1000000, 10000000, 50000000, 100000000, 500000000],
          "range": [10, 50, 150, 200, 300, 400]
          },
          "legend": {"format": ".1s"}
          },
    "color": {
      "field": "Continent",
      "type": "nominal",
      "scale": {
      "domain": [
      "North America",
      "South America",
      "Europe",
      "Africa",
      "Asia",
      "Oceania"
      ],
      "range": [
      "#e41a1c",
      "#984ea3",
      "#ff7f00",
      "#a6cee3",
      "#377eb8",
      "#a65628"
      ]
     }
     },
          "opacity": {
              "condition": {"selection": "continent_highlight", "value": 0.6},
              "value": 0.3
              },
    "tooltip":[{"field":"Continent","type": "nominal"}, {"field": "Entity", "type": "nominal"},
    {"field": "Population","type": "quantitative"},
   {"aggregate":"average","field": "Cases", "type": "quantitative","title":"average cases"}]
  }
  },

{
"mark": {
  "type": "text",
  "align": "right",
  "baseline": "middle",
  "dx": -12,
  "fontSize": 11,
  "fontStyle": "italic"},
  "encoding": {
  "text": {"field": "Entity", "type": "nominal"},  
  "color": {"value": "black"},
  "opacity": {
  "condition": {
  "test": "datum['Entity'] == 'China' || datum['Entity'] == 'Australia' || datum['Entity'] == 'India' ||datum['Entity'] == 'United States' ||datum['Entity'] == 'United Kingdom'||datum['Entity'] == 'Italy'||datum['Entity'] == 'France'",
  "value": 1},
  "value": 0
 },
 "tooltip":[{"field":"Continent","type": "nominal"}, {"field": "Entity", "type": "nominal"},
    {"field": "Population","type": "quantitative"},
   {"aggregate":"average","field": "Cases", "type": "quantitative","title":"average cases"}]
 }
}
]
}

